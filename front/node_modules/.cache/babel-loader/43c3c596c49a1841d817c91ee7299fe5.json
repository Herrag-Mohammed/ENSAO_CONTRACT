{"remainingRequest":"/Users/mohammedherrag/projet_PFA/front/node_modules/babel-loader/lib/index.js!/Users/mohammedherrag/projet_PFA/front/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/mohammedherrag/projet_PFA/front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mohammedherrag/projet_PFA/front/src/components/Upload.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mohammedherrag/projet_PFA/front/src/components/Upload.vue","mtime":1624550253543},{"path":"/Users/mohammedherrag/projet_PFA/front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mohammedherrag/projet_PFA/front/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/mohammedherrag/projet_PFA/front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mohammedherrag/projet_PFA/front/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9tb2hhbW1lZGhlcnJhZy9wcm9qZXRfUEZBL2Zyb250L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UuanMiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgQmxja2NobkFudFByb3ZlciBmcm9tICcuLi9saWIvQmxja2NobkFudFByb3Zlci5qcyc7CmltcG9ydCBRcmNvZGVWdWUgZnJvbSAncXJjb2RlLnZ1ZSc7CmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICBRcmNvZGVWdWU6IFFyY29kZVZ1ZQogIH0sCiAgbmFtZTogJ1VwbG9hZCcsCiAgcHJvcHM6IHt9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjb21wdXRpbmc6IGZhbHNlLAogICAgICBmaWxlOiBudWxsLAogICAgICBmb3JtOiB7CiAgICAgICAgaGFzaGNvZGU6IG51bGwsCiAgICAgICAgY29tbWVudDogbnVsbAogICAgICB9LAogICAgICB0cmFuc2FjdGlvblJlc3VsdDogbnVsbCwKICAgICAgc2hvdzogdHJ1ZSwKICAgICAgZXJyb3I6IG51bGwKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgdHJhbnNhY3Rpb25Vcmw6IGZ1bmN0aW9uIHRyYW5zYWN0aW9uVXJsKCkgewogICAgICB2YXIgYmFzZVVybCA9IEJsY2tjaG5BbnRQcm92ZXIuZXRoZXJzY2FuQmFzZVVybCgpOwogICAgICByZXR1cm4gYmFzZVVybCAmJiB0aGlzLnRyYW5zYWN0aW9uUmVzdWx0ID8gYmFzZVVybCArICcvdHgvJyArIHRoaXMudHJhbnNhY3Rpb25SZXN1bHQgOiBudWxsOwogICAgfSwKICAgIG5lZWRNZXRhbWFzazogZnVuY3Rpb24gbmVlZE1ldGFtYXNrKCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUucHJvdmlkZXJUeXBlID09PSBmYWxzZSA/ICdWZXVpbGxleiBpbnN0YWxsZXIgTWV0YW1hc2snIDogbnVsbDsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGZpbGVDaG9zZW46IGZ1bmN0aW9uIGZpbGVDaG9zZW4oZXZ0KSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciB0aGVGaWxlOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHRoZUZpbGUgPSBldnQudGFyZ2V0LmZpbGVzWzBdOwogICAgICAgICAgICAgICAgX3RoaXMuZm9ybS5jb21tZW50ID0gdGhlRmlsZS5uYW1lOwogICAgICAgICAgICAgICAgX3RoaXMuZm9ybS5oYXNoY29kZSA9ICcnOwogICAgICAgICAgICAgICAgX3RoaXMuY29tcHV0aW5nID0gdHJ1ZTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2OwogICAgICAgICAgICAgICAgcmV0dXJuIEJsY2tjaG5BbnRQcm92ZXIuY2FsY3VsYXRlSGFzaEZyb21GaWxlKHRoZUZpbGUpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICBfdGhpcy5mb3JtLmhhc2hjb2RlID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICAgIF90aGlzLmNvbXB1dGluZyA9IGZhbHNlOwoKICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgb25TdWJtaXQ6IGZ1bmN0aW9uIG9uU3VibWl0KGV2dCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICB0aGlzLnRyYW5zYWN0aW9uUmVzdWx0ID0gbnVsbDsKICAgICAgdGhpcy5lcnJvciA9IG51bGw7CiAgICAgIEJsY2tjaG5BbnRQcm92ZXIuc2VuZEhhc2godGhpcy5mb3JtLmhhc2hjb2RlLCB0aGlzLmZvcm0uY29tbWVudCwgZnVuY3Rpb24gKGVycm9yLCB0cmFuc2FjdGlvbikgewogICAgICAgIGlmIChlcnJvcikgewogICAgICAgICAgX3RoaXMyLmVycm9yID0gZXJyb3I7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBfdGhpczIudHJhbnNhY3Rpb25SZXN1bHQgPSB0cmFuc2FjdGlvbjsKICAgICAgfSk7CiAgICB9LAogICAgb25SZXNldDogZnVuY3Rpb24gb25SZXNldChldnQpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICBldnQucHJldmVudERlZmF1bHQoKTsKICAgICAgdGhpcy50cmFuc2FjdGlvblJlc3VsdCA9IG51bGw7CiAgICAgIHRoaXMuZmlsZSA9IG51bGw7CiAgICAgIHRoaXMuZm9ybS5oYXNoY29kZSA9IG51bGw7CiAgICAgIHRoaXMuZm9ybS5jb21tZW50ID0gbnVsbDsgLy8gVHJpY2sgdG8gcmVzZXQvY2xlYXIgbmF0aXZlIGJyb3dzZXIgZm9ybSB2YWxpZGF0aW9uIHN0YXRlCgogICAgICB0aGlzLnNob3cgPSBmYWxzZTsKICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzMy5zaG93ID0gdHJ1ZTsKICAgICAgfSk7CiAgICB9LAogICAgZmlsZU5hbWVGb3JtYXR0ZXI6IGZ1bmN0aW9uIGZpbGVOYW1lRm9ybWF0dGVyKGZpbGVzKSB7CiAgICAgIHZhciBtYXggPSA1MDsKICAgICAgcmV0dXJuIGZpbGVzWzBdLm5hbWUubGVuZ3RoIDwgbWF4ID8gZmlsZXNbMF0ubmFtZSA6IGZpbGVzWzBdLm5hbWUuc2xpY2UoMCwgbWF4KSArICcuLi4nOwogICAgfQogIH0KfTs="},{"version":3,"sources":["Upload.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"upload\">\n    \n    <b-card title=\"üìå J'ancre un contenu\">\n        <b-card-text>\n          Le fichier que je charge reste confidentiel : il doit √™tre conserv√©.\n          Son empreinte, le commentaire et mon compte sont horodat√©s.\n        </b-card-text>\n\n        <b-form @submit=\"onSubmit\" @reset=\"onReset\" v-if=\"show\">\n\n            <b-form-group label=\"Fichier\" label-for=\"upload-file\" label-cols-sm=\"2\" label-size=\"lg\"\n              description=\"L'empreinte est calcul√©e automatiquement\">\n              <b-form-file id=\"upload-file\" size=\"lg\"\n                v-model=\"file\" :state=\"Boolean(file)\"\n                placeholder=\"Choisir un fichier ou le d√©poser ici...\"\n                drop-placeholder=\"D√©poser le fichier ici...\"\n                v-on:change=\"fileChosen\"\n                :file-name-formatter=\"fileNameFormatter\"\n              ></b-form-file>\n            </b-form-group>\n\n            <b-form-group label=\"Commentaire\" label-for=\"comment\" label-cols-sm=\"2\" label-size=\"lg\">\n              <b-form-input id=\"comment\" size=\"lg\" v-model=\"form.comment\" required\n                placeholder=\"Entrer un commentaire...\"\n              ></b-form-input>\n            </b-form-group>\n\n            <b-form-group v-if=\"form.hashcode\" label=\"Donn√©es √† ancrer dans la blockchain\" label-for=\"proof-content\" label-cols-sm=\"2\" label-size=\"lg\">\n              <b-card class=\"json-code\">\n                <pre><code id=\"proof-content\">{{form}}</code></pre>\n              </b-card>\n            </b-form-group>\n\n            <b-form-group label-for=\"btns\" label-cols-sm=\"2\">\n                <b-button-group id=\"btns\" size=\"lg\">\n                    <b-button type=\"submit\" variant=\"primary\" :title=\"needMetamask\" :disabled=\"$store.state.providerType===false || computing\">\n                      <div v-if=\"computing\"><b-spinner type=\"grow\"/> Calcul</div>\n                      <div v-else><i class=\"icon-law\"/> R√©f√©rencer</div>\n                    </b-button>\n                    <b-button type=\"reset\">R√©initialiser</b-button>\n                </b-button-group>\n                <div v-if=\"error\" class=\"error\">{{error}}</div>\n            </b-form-group>\n\n            <b-form-group v-if=\"transactionResult\" label=\"Transaction\" label-for=\"transaction-id\" label-cols-sm=\"2\" label-size=\"lg\">\n                <b-card class=\"json-code\">\n                  <pre><code id=\"transaction-id\">{{transactionResult}}</code></pre>\n                </b-card>\n                <a class=\"transaction\" v-if=\"transactionResult && transactionUrl\" :href=\"transactionUrl\" target=\"_blank\" rel=\"noopener\">\n                  <qrcode-vue className=\"qrcode\" :value=\"transactionUrl\" :foreground=\"'#2c3e50'\"></qrcode-vue>\n                </a>\n                <div v-if=\"transactionResult\" class=\"info\">Lorsqu'elles sont valid√©es, les transacions apparaissent dans le bloc \"√©v√©nements\". Veuillez r√©cup√©rer le certificat afin de le conserver avec le document.</div>\n            </b-form-group>\n        </b-form>\n    </b-card>\n  </div>\n</template>\n\n<script>\n\nimport BlckchnAntProver from '../lib/BlckchnAntProver.js'\nimport QrcodeVue from 'qrcode.vue'\n\nexport default {\n  components: {\n    QrcodeVue\n  },\n  name: 'Upload',\n  props: {\n  },\n  data() {\n    return {\n      computing: false,\n      file: null,\n      form: {\n        hashcode: null,\n        comment: null\n      },\n      transactionResult: null,\n      show: true,\n      error: null\n    }\n  },\n\n  computed: {\n    transactionUrl: function () {\n      let baseUrl = BlckchnAntProver.etherscanBaseUrl()\n      return baseUrl && this.transactionResult  ? baseUrl + '/tx/' + this.transactionResult : null\n    },\n    needMetamask: function () {\n      return this.$store.state.providerType===false ? 'Veuillez installer Metamask' : null\n    }\n  },\n  \n  methods: {\n      async fileChosen(evt) {\n        let theFile = evt.target.files[0]\n        this.form.comment = theFile.name\n        this.form.hashcode = ''\n        this.computing = true\n        this.form.hashcode = await BlckchnAntProver.calculateHashFromFile(theFile)\n        this.computing = false\n      },\n      onSubmit(evt) {\n        evt.preventDefault()\n        this.transactionResult = null\n        this.error = null\n        BlckchnAntProver.sendHash(this.form.hashcode, this.form.comment, (error, transaction) => {\n          if (error) {\n            this.error = error\n            return\n          }\n          this.transactionResult = transaction\n        })\n      },\n      onReset(evt) {\n        evt.preventDefault()\n        this.transactionResult = null\n        this.file = null\n        this.form.hashcode = null\n        this.form.comment = null\n        // Trick to reset/clear native browser form validation state\n        this.show = false\n        this.$nextTick(() => {\n          this.show = true\n        })\n      },\n      fileNameFormatter(files) {\n        let max = 50\n        return files[0].name.length<max ? files[0].name : files[0].name.slice(0, max)+'...'\n      }\n    }\n}\n</script>\n\n<style scoped>\n>>> .custom-file-input ~ .custom-file-label[data-browse]::after {\n  content: 'Parcourir';\n}\n.error {\n  margin-top: 10px;\n  color: red;\n}\n.error::before {\n  content: \"‚õê \";\n}\n.transaction {\n  margin-top: 5px;\n}\n.qrcode, .info {\n  display: block;\n  float: left;\n  padding-left: 20px;\n}\n.qrcode {\n  padding-top: 5px;\n}\n</style>\n"],"sourceRoot":"src/components"}]}